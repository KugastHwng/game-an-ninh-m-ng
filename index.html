<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini Game Full Version Kh√¥ng √Çm Thanh</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
body { margin:0; font-family:'Poppins', sans-serif; overflow:hidden; background: linear-gradient(#6bd5ff, #b9f1ff); }

/* INTRO */
#introContainer,#outroScreen { width:100vw; height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; padding:20px; box-sizing:border-box; }
#outroScreen { display:none; flex-direction:column; justify-content:center; align-items:center; text-align:center; animation: bgFade 5s ease-in-out infinite; }

/* Name input */
#nameBox { display:none; margin-top:20px; text-align:center; }
#playerName { padding:10px; font-size:18px; border-radius:10px; border:2px solid #5ab4ff; }

/* H∆∞·ªõng d·∫´n tr√™n th√°p */
#towerGuide { text-align:center; font-size:20px; color:#004b70; margin-top:20px; display:none; }

/* GAME */
#gameTitle { display:none; text-align:center; margin-top:20px; color:#0077c8; }
.game-area { display:none; flex-direction:row; justify-content:center; align-items:flex-end; gap:20px; margin-top:20px; position:relative; height:400px; }
.tower { width:120px; height:150px; border-radius:20px 20px 0 0; display:flex; flex-direction:column; align-items:center; justify-content:flex-end; cursor:pointer; position:relative; box-shadow:0 8px 20px rgba(0,0,0,0.25); transition:0.3s; }
.tower:hover { transform: scale(1.05); }
.roof { width:120px; height:40px; clip-path: polygon(50% 0%, 100% 100%, 0% 100%); margin-bottom:0; box-shadow:0 4px 10px rgba(0,0,0,0.3); }

#tower1 { background:#ffe5b4; } #tower1 .roof { background:#ff7f50; }
#tower2 { background:#d0f0c0; } #tower2 .roof { background:#32cd32; }
#tower3 { background:#c0d6f0; } #tower3 .roof { background:#1e90ff; }
#tower4 { background:#f4c2c2; } #tower4 .roof { background:#ff4500; }

.character { width:50px; height:50px; background:#ffeb3b; border-radius:50%; position:absolute; display:flex; align-items:center; justify-content:center; font-size:24px; z-index:5; transition:0.3s; }

/* POPUP */
.popup { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:20px; border-radius:15px; box-shadow:0 8px 25px rgba(0,0,0,0.35); display:none; z-index:10; width:350px; }
.popup h2 { margin-top:0; color:#0077c8; }
.popup button { width:100%; padding:12px; background:#00a8ff; color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer; margin-top:5px; }
.popup button:hover { background:#0077c8; }

.tower.level1 { box-shadow:0 0 10px 3px gold; height:200px; }
.tower.level2 { box-shadow:0 0 15px 5px orange; height:250px; }
.tower.level3 { box-shadow:0 0 25px 8px red; height:300px; }

/* Gradient animation outro */
@keyframes bgFade {
  0% { background: linear-gradient(#6bd5ff, #b9f1ff); }
  50% { background: linear-gradient(#b9f1ff, #6bd5ff); }
  100% { background: linear-gradient(#6bd5ff, #b9f1ff); }
}
</style>
</head>
<body>

<!-- === NH·∫†C N·ªÄN === -->
<audio id="bgMusic" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<!-- === √ÇM THANH ƒê√öNG ‚Äì SAI === -->
<audio id="correctSound">
  <source src="correct.mp3" type="audio/mpeg">
</audio>

<audio id="wrongSound">
  <source src="wrong.mp3" type="audio/mpeg">
</audio>

<!-- INTRO -->
<div id="introContainer">
  <div id="introText"></div>
  <div id="nameBox">
    <label>Nh·∫≠p t√™n c·ªßa b·∫°n:</label><br>
    <input id="playerName" type="text"><br>
    <button onclick="startGame()">B·∫Øt ƒë·∫ßu</button>
  </div>
</div>

<!-- N√öT HI·ªÇN TH·ªä H∆Ø·ªöNG D·∫™N -->
<div style="text-align:center; margin-top:10px;">
  <button id="towerGuideBtn" style="padding:10px 16px; background:#00a8ff; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:600;" onclick="openTowerGuide()">H∆∞·ªõng d·∫´n Th√°p</button>
</div>

<!-- POPUP H∆Ø·ªöNG D·∫™N -->
<div id="towerGuidePopup" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:50; justify-content:center; align-items:center; padding:20px; display:flex;">
  <div style="background:#fff; max-width:700px; width:100%; border-radius:12px; padding:20px; box-shadow:0 12px 35px rgba(0,0,0,0.35); overflow:auto; max-height:80vh;">
    <h2 style="margin-top:0; color:#0077c8;">H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng ‚Äî 4 t√≤a th√°p</h2>
    <p><strong>M·ª•c ti√™u:</strong> Tr·∫£ l·ªùi ƒë√∫ng c√°c c√¢u h·ªèi ƒë·ªÉ n√¢ng c·∫•p 4 t√≤a th√°p l√™n m·ª©c t·ªëi ƒëa.</p>
    <ol style="text-align:left; padding-left:18px;">
      <li><strong>Nh·∫≠p t√™n:</strong> Nh·∫≠p t√™n r·ªìi nh·∫•n <em>B·∫Øt ƒë·∫ßu</em>.</li>
      <li><strong>Ch·ªçn t√≤a th√°p:</strong> Nh·∫•p v√†o t√≤a th√°p b·∫°n mu·ªën tr·∫£ l·ªùi.</li>
      <li><strong>Tr·∫£ l·ªùi 1 c√¢u:</strong> M·ªói th√°p ch·ªâ c√≥ 1 c√¢u h·ªèi, ch·ªçn 1 trong 3 ƒë√°p √°n.</li>
      <li><strong>N√¢ng c·∫•p :</strong> N·∫øu ƒë√∫ng, th√°p s·∫Ω ƒë·∫°t m·ª©c t·ªëi ƒëa ngay.</li>
      <li><strong>Th·ª≠ l·∫°i khi sai:</strong> N·∫øu sai, c√≥ th√¥ng b√°o, b·∫°n c√≥ th·ªÉ th·ª≠ l·∫°i.</li>
      <li><strong>Ho√†n th√†nh tr√≤ ch∆°i:</strong> Khi c·∫£ 4 th√°p ƒë·ªÅu ƒë·∫°t m·ª©c t·ªëi ƒëa, m√†n kh√°c s·∫Ω xu·∫•t hi·ªán.</li>
    </ol>
    <p style="font-size:13px; color:#555; margin-top:10px;">B·∫°n c√≥ th·ªÉ l√†m th√°p theo b·∫•t k·ª≥ th·ª© t·ª± n√†o. Tr√≤ ch∆°i s·∫Ω ƒë·∫øm th·ªùi gian b·∫°n ch∆°i khi b·∫°n nh·∫•n b·∫Øt ƒë·∫ßu.</p>
    <div style="text-align:right; margin-top:12px;">
      <button style="padding:10px 16px; background:#ff6b6b; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:600;" onclick="closeTowerGuide()">ƒê√≥ng</button>
    </div>
  </div>
</div>

<!-- H∆∞·ªõng d·∫´n tr√™n th√°p -->
<div id="towerGuide" style="display:none;">
  Ch·ªçn v√†o m·ªói t√≤a th√°p ‚Äî m·ªói t√≤a t∆∞·ª£ng tr∆∞ng cho m·ªôt t√†i kho·∫£n c·ªßa Minh. Nh·∫•p v√†o th√°p ƒë·ªÉ ƒë·∫∑t m·∫≠t kh·∫©u m·∫°nh!
</div>

<!-- GAME -->
<h1 id="gameTitle">Mini Game: Ch·ªçn m·∫≠t kh·∫©u m·∫°nh ƒë·ªÉ n√¢ng c·∫•p th√°p</h1>
<div class="game-area" id="gameArea">
  <div class="tower" id="tower1"><div class="roof"></div></div>
  <div class="tower" id="tower2"><div class="roof"></div></div>
  <div class="tower" id="tower3"><div class="roof"></div></div>
  <div class="tower" id="tower4"><div class="roof"></div></div>
  <div class="character" id="character">üòä</div>
</div>

<!-- POPUP -->
<div class="popup" id="popup">
  <h2 id="questionTitle">Ch·ªçn m·∫≠t kh·∫©u</h2>
  <div id="answers"></div>
</div>

<!-- POPUP CU·ªêI TH√ÅP -->
<div class="popup" id="finalPopup">
  <h2>Ch√∫c m·ª´ng!</h2>
  <p>B·∫°n ƒë√£ gi√∫p Minh ƒë·∫∑t m·∫≠t kh·∫©u m·∫°nh, nh∆∞ng ƒë·ªÉ sau n√†y Minh kh√¥ng ƒë·∫∑t m·∫≠t kh·∫©u y·∫øu n·ªØa, b·∫°n n√™n cho Minh 1 s·ªë l·ªùi khuy√™n.</p>
  <button id="nextGameBtn">ƒê∆∞·ª£c th√¥i</button>
</div>

<!-- POPUP L·ªúI KHUY√äN -->
<div class="popup" id="advicePopup">
  <h2 id="adviceQuestion">C√¢u h·ªèi</h2>
  <div id="adviceAnswers"></div>
</div>

<!-- OUTRO -->
<div id="outroScreen">
  <h1 id="outroTitle" style="opacity:0; transition:opacity 1s;">Thank for playing!</h1>
  <p id="outroText" style="opacity:0; transition:opacity 1s;">B·∫°n ƒë√£ ho√†n th√†nh tr√≤ ch∆°i.H√£y chia s·∫ª cho b·∫°n b√® c√πng ch∆°i nh√©.H·∫πn g·∫∑p l·∫°i!</p>
  <div id="outroCharacter" style="width:80px; height:80px; background:#ffeb3b; border-radius:50%; margin-top:30px; display:flex; justify-content:center; align-items:center; font-size:36px; opacity:0; transition:opacity 1s;">üòä</div>
</div>

<script>
// --- INTRO ---
const introLines=["B·∫°n l√† 1 nh√† th√°m hi·ªÉm internet...","Trong l√∫c th√°m hi·ªÉm b·∫°n g·∫∑p Minh ‚Äì 1 ng∆∞·ªùi ƒëang b·ªã nh·ªØng t√™n hacker ƒë√°nh c·∫Øp th√¥ng tin...","Nhi·ªám v·ª• c·ªßa b·∫°n l√† gi√∫p Minh ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u!"];
let lineIndex=0,charIndex=0;
const introText=document.getElementById("introText");
const nameBoxEl=document.getElementById("nameBox");

function typeIntro(){
  introText.innerHTML = ""; 
  lineIndex=0; charIndex=0;

  function typing(){
    if(lineIndex<introLines.length){
      if(charIndex<introLines[lineIndex].length){
        introText.innerHTML+=introLines[lineIndex].charAt(charIndex);
        charIndex++;
        setTimeout(typing,40);
      } else {
        introText.innerHTML+="<br><br>";
        lineIndex++; charIndex=0;
        setTimeout(typing,500);
      }
    } else {
      nameBoxEl.style.display="block";
    }
  }

  typing();
}

// KH√îNG CH·∫†Y INTRO KHI LOAD TRANG N·ªÆA
// window.onload = typeIntro;

// --- NH·∫†C ---
const bgMusic=document.getElementById("bgMusic");
const correctSound=document.getElementById("correctSound");
const wrongSound=document.getElementById("wrongSound");
let bgStart=false;

document.addEventListener("click",()=>{
  if(!bgStart){
    bgMusic.volume=0.5;
    bgMusic.play().catch(()=>{});
    bgStart=true;
  }
});

// --- GAME DATA ---
const towersData = {
  tower1: [{question: "Ch·ªçn m·∫≠t kh·∫©u m·∫°nh.", answers: [{ text: "12345", correct: false },{ text: "Huy3#2025", correct: true },{ text: "abcdef", correct: false }]}],
  tower2: [{question: "Ch·ªçn m·∫≠t kh·∫©u c√≥ s·ªë v√† ch·ªØ vi·∫øt hoa.", answers: [{ text: "Pass1234", correct: true },{ text: "abcdefg", correct: false },{ text: "Password", correct: false }]}],
  tower3: [{question: "Ch·ªçn m·∫≠t kh·∫©u c√≥ ch·ªØ hoa, ch·ªØ th∆∞·ªùng,s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát.", answers: [{ text: "ABCDEFG", correct: false },{ text: "1234567", correct: false },{ text: "Hoctap@1235", correct: true }]}],
  tower4: [{question: "Ch·ªçn m·∫≠t kh·∫©u ƒë·ªß 8 k√Ω t·ª± tr·ªü l√™n.", answers: [{ text: "12a424a", correct: false },{ text: "SafePassw1", correct: true },{ text: "chamchi@!", correct: false }]}]
};

const towers=document.querySelectorAll('.tower');
const popup=document.getElementById('popup');
const questionTitle=document.getElementById('questionTitle');
const answersDiv=document.getElementById('answers');
const character=document.getElementById('character');
const gameArea=document.getElementById('gameArea');
const gameTitle=document.getElementById('gameTitle');
const towerGuide=document.getElementById('towerGuide');
const finalPopup=document.getElementById('finalPopup');
const advicePopup=document.getElementById('advicePopup');
const adviceQuestionEl=document.getElementById('adviceQuestion');
const adviceAnswersDiv=document.getElementById('adviceAnswers');
const outroScreen=document.getElementById('outroScreen');
const outroChar=document.getElementById('outroCharacter');

let currentTower=null;
let currentLevel={tower1:0,tower2:0,tower3:0,tower4:0};

function startGame(){
  const nameInput=document.getElementById('playerName').value;
  document.getElementById('introContainer').style.display="none";
  towerGuide.style.display="block";
  gameTitle.style.display="block";
  gameArea.style.display="flex";
}

towers.forEach(tower=>{
  tower.addEventListener('click',()=>{
    currentTower=tower.id;
    const rect=tower.getBoundingClientRect();
    const areaRect=gameArea.getBoundingClientRect();
    const x=rect.left-areaRect.left+rect.width/2-character.offsetWidth/2;
    const y=-character.offsetHeight;
    character.style.left=x+'px';
    character.style.top=y+'px';
    showTowerQuestion(currentTower);
  });
});

function showTowerQuestion(towerId){
  const level=currentLevel[towerId];
  if(level>=1){ checkAllTowersCompleted(); return; }
  const q=towersData[towerId][0];
  questionTitle.textContent=q.question;
  answersDiv.innerHTML="";
  q.answers.forEach(ans=>{
    const btn=document.createElement('button');
    btn.textContent=ans.text;
    btn.onclick=()=>checkTowerAnswer(ans.correct);
    answersDiv.appendChild(btn);
  });
  popup.style.display='block';
}

function checkTowerAnswer(isCorrect){
  if(isCorrect){
    correctSound.currentTime=0; correctSound.play();
    alert("Ch·ªçn ƒë√∫ng! Th√°p ƒë∆∞·ª£c n√¢ng c·∫•p üéâ");
    const towerEl=document.getElementById(currentTower);
    currentLevel[currentTower]=3;
    towerEl.classList.add("level3");
  } else { wrongSound.currentTime=0; wrongSound.play(); alert("M·∫≠t kh·∫©u y·∫øu, th·ª≠ l·∫°i üò¢"); }
  popup.style.display='none';
  checkAllTowersCompleted();
}

function checkAllTowersCompleted(){
  const allDone=Object.values(currentLevel).every(l=>l>=1);
  if(allDone){ finalPopup.style.display='block'; }
}

document.getElementById('nextGameBtn').onclick=()=>{ finalPopup.style.display='none'; showAdviceGame(); };

// ---- GAME L·ªúI KHUY√äN ----
const adviceQuestions=[
  {q:"Khi ƒë·∫∑t m·∫≠t kh·∫©u, b·∫°n c·∫ßn ___ ƒë·ªÉ b·∫£o m·∫≠t t·ªët h∆°n.",answers:[
    {text:"s·ª≠ d·ª•ng ch·ªØ hoa, ch·ªØ th∆∞·ªùng, s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát",correct:true},
    {text:"ch·ªâ d√πng s·ªë",correct:false},
    {text:"d√πng t√™n m√¨nh",correct:false}]},
  {q:"M·∫≠t kh·∫©u n√™n c√≥ √≠t nh·∫•t ___ k√Ω t·ª±.",answers:[
    {text:"4 k√Ω t·ª±",correct:false},
    {text:"8 k√Ω t·ª±",correct:true},
    {text:"2 k√Ω t·ª±",correct:false}]},
  {q:"Kh√¥ng n√™n s·ª≠ d·ª•ng ___ trong m·∫≠t kh·∫©u.",answers:[
    {text:"t√™n ng∆∞·ªùi th√¢n ho·∫∑c ng√†y sinh",correct:true},
    {text:"k√Ω t·ª± ƒë·∫∑c bi·ªát",correct:false},
    {text:"ch·ªØ v√† s·ªë",correct:false}]},
  {q:"N√™n thay ƒë·ªïi m·∫≠t kh·∫©u ___ ƒë·ªÉ tr√°nh b·ªã hack.",answers:[
    {text:"kh√¥ng bao gi·ªù",correct:false},
    {text:"th∆∞·ªùng xuy√™n",correct:true},
    {text:"ch·ªâ khi b·ªã qu√™n",correct:false}]},
  {q:"Kh√¥ng n√™n s·ª≠ d·ª•ng ___ gi·ªëng nhau cho nhi·ªÅu t√†i kho·∫£n.",answers:[
    {text:"m·∫≠t kh·∫©u",correct:true},
    {text:"email",correct:false},
    {text:"t√™n ƒëƒÉng nh·∫≠p",correct:false}]}];

let adviceIndex=0;
function showAdviceGame(){ adviceIndex=0; showAdviceQuestion(); }
function showAdviceQuestion(){
  if(adviceIndex>=adviceQuestions.length){ advicePopup.style.display='none'; showOutro(); return; }
  const q=adviceQuestions[adviceIndex];
  adviceQuestionEl.textContent=q.q;
  adviceAnswersDiv.innerHTML="";
  q.answers.forEach(ans=>{
    const btn=document.createElement('button');
    btn.textContent=ans.text;
    btn.onclick=()=>{
      if(ans.correct){ correctSound.currentTime=0; correctSound.play(); alert("Ch·ªçn ƒë√∫ng! üéâ"); adviceIndex++; }
      else{ wrongSound.currentTime=0; wrongSound.play(); alert("Sai, th·ª≠ l·∫°i üò¢"); }
      showAdviceQuestion();
    };
    adviceAnswersDiv.appendChild(btn);
  });
  advicePopup.style.display='block';
}

// --- OUTRO ---
function showOutro(){
  advicePopup.style.display='none';
  gameArea.style.display='none';
  gameTitle.style.display='none';
  towerGuide.style.display='none';
  outroScreen.style.display='flex';
  setTimeout(()=>document.getElementById('outroTitle').style.opacity=1,100);
  setTimeout(()=>document.getElementById('outroText').style.opacity=1,1100);
  setTimeout(()=>outroChar.style.opacity=1,2100);
}

// --- H∆Ø·ªöNG D·∫™N TH√ÅP ---
function openTowerGuide(){
  document.getElementById('towerGuidePopup').style.display='flex';
}

function closeTowerGuide(){
  document.getElementById('towerGuidePopup').style.display='none';
  typeIntro();  // << B·∫ÆT ƒê·∫¶U INTRO SAU KHI ·∫§N ƒê√ìNG
}
</script>

</body>
</html>
